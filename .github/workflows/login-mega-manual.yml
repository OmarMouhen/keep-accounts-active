name: login-mega-manual


on:
  [workflow_dispatch]


concurrency:
  group: login-and-schedule
  cancel-in-progress: false


jobs:

  get-folder-name:
    runs-on: ubuntu-latest
    
    # Solution to pass variables between jobs in a workflow without using artifacts
    # https://user-images.githubusercontent.com/6890249/181096846-f7fdc90f-8d43-4bb9-9290-fefc9ad0bd84.png
    # by dimisjim on 11 Mar 2021
    # https://github.com/orgs/community/discussions/26313
    
    outputs:
          output1: ${{ steps.getname.outputs.foldername }}
    
    steps:
          - name: Get folder name from current workflow name
            id: getname
            run: |
              read -ra Arr <<< ${{ github.workflow }}
              folder=${Arr[1]}
              echo "folder name is $folder"
              echo "::set-output name=foldername::$folder"


  call-workflow:
    needs: get-folder-name
    uses: schmwong/keep-accounts-active/.github/workflows/reusable-autolog.yml@first-reusable-workflow
    with:
      folder: ${{ needs.get-folder-name.outputs.output1 }}
      platform-name: Mega
      secrets: inherit
              
